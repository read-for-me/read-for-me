{"openapi":"3.1.0","info":{"title":"Read-For-Me Backend","version":"0.1.0"},"paths":{"/api/v1/crawl":{"post":{"tags":["crawl"],"summary":"URL 크롤링","description":"URL을 받아 크롤링 후 정제된 아티클을 반환합니다.\n\n## 처리 흐름\n1. CrawlerFactory로 적절한 크롤러 선택\n2. crawler.extract()로 콘텐츠 추출\n3. CleanedArticle.from_crawled()로 변환 후 반환\n\n## 지원 플랫폼\n- GeekNews: `https://news.hada.io/topic?id=XXXXX`\n- Medium: `https://medium.com/@username/...`\n- 일반 웹사이트: trafilatura 기반 범용 크롤러\n\n## 저장 경로\n- `data/users/{user_id}/crawled/{article_id}_{timestamp}.json`\n\n## 에러 코드\n- INVALID_URL_FORMAT (400): 잘못된 URL 형식\n- EMPTY_INPUT (400): 빈 입력\n- UNSUPPORTED_CONTENT (415): 지원 불가 콘텐츠 (YouTube, Twitter 등)\n- NO_CONTENT (422): 콘텐츠 없음 (빈 페이지)\n- CRAWL_FAILED (502): 크롤링 실패\n- TIMEOUT (504): 타임아웃\n\nArgs:\n    request: 크롤링 요청 (url, user_id 필드 포함)\n    \nReturns:\n    CleanedArticle: 정제된 아티클 데이터\n    \nRaises:\n    HTTPException: 크롤링 실패 시","operationId":"crawl_url_api_v1_crawl_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CrawlRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CleanedArticle"}}}},"400":{"description":"잘못된 URL 형식 또는 빈 입력","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CrawlErrorResponse"}}}},"415":{"description":"지원 불가 콘텐츠","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CrawlErrorResponse"}}}},"422":{"description":"콘텐츠 없음","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CrawlErrorResponse"}}}},"502":{"description":"크롤링 실패","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CrawlErrorResponse"}}}},"504":{"description":"타임아웃","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CrawlErrorResponse"}}}}}}},"/api/v1/crawl/supported-domains":{"get":{"tags":["crawl"],"summary":"지원 도메인 목록","description":"지원하는 도메인 목록을 반환합니다.\n\nReturns:\n    list[str]: 지원하는 도메인 패턴 목록\n    \nExample:\n    ```json\n    [\"news.hada.io\", \"medium.com\"]\n    ```","operationId":"get_supported_domains_api_v1_crawl_supported_domains_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"items":{"type":"string"},"type":"array","title":"Response Get Supported Domains Api V1 Crawl Supported Domains Get"}}}}}}},"/api/v1/crawl/check-support":{"get":{"tags":["crawl"],"summary":"URL 지원 여부 확인","description":"URL이 지원되는지 확인합니다.\n\n플랫폼 감지 결과:\n- geeknews: GeekNews 전용 크롤러\n- medium: Medium 전용 크롤러  \n- generic: trafilatura 기반 범용 크롤러\n- unsupported: 지원하지 않는 URL (YouTube, Twitter 등)\n\nArgs:\n    url: 확인할 URL (쿼리 파라미터)\n    \nReturns:\n    UrlSupportResponse: 지원 여부 및 플랫폼 정보\n    \nExample:\n    ```\n    GET /api/v1/crawl/check-support?url=https://news.hada.io/topic?id=24268\n    \n    Response:\n    {\n        \"url\": \"https://news.hada.io/topic?id=24268\",\n        \"is_supported\": true,\n        \"platform\": \"geeknews\",\n        \"is_specialized\": true,\n        \"domain\": \"news.hada.io\",\n        \"error_code\": null,\n        \"error_message\": null\n    }\n    ```","operationId":"check_url_support_api_v1_crawl_check_support_get","parameters":[{"name":"url","in":"query","required":true,"schema":{"type":"string","description":"확인할 URL","title":"Url"},"description":"확인할 URL"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UrlSupportResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/summarize":{"post":{"tags":["summarize"],"summary":"Summarize Content","description":"콘텐츠를 요약합니다.\n\n- **content**: 요약할 텍스트 콘텐츠 (최소 10자)\n- **url**: 원본 URL (선택, 캐싱용)\n- **article_id**: 아티클 ID (선택, 저장용). 없으면 자동 생성\n- **user_id**: 사용자 ID (선택). 없으면 기본값 'default' 사용\n\n## 저장 경로\n- `data/users/{user_id}/summary/{article_id}_{timestamp}.json`\n\nReturns:\n    요약 결과 (bullet_points, main_topic, model, processing_time_ms, article_id, saved_path)","operationId":"summarize_content_api_v1_summarize_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SummarizeRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SummarizeResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/summarize/stream":{"post":{"tags":["summarize"],"summary":"Summarize Stream","description":"SSE 스트리밍으로 콘텐츠를 요약합니다.\n\n## 이벤트 타입\n- **thinking**: AI의 추론 과정 텍스트\n- **content**: 요약 텍스트 청크\n- **done**: 최종 완료 결과 (SummarizeResponse와 동일한 구조)\n- **error**: 에러 발생\n\n## 이벤트 형식 (SSE)\n```\nevent: thinking\ndata: {\"text\": \"글의 핵심을 분석하고 있습니다...\"}\n\nevent: content\ndata: {\"text\": \"[주제]\\nAI 시대의 변화...\"}\n\nevent: done\ndata: {\"bullet_points\": [...], \"main_topic\": \"...\", \"model\": \"...\", ...}\n```\n\nReturns:\n    StreamingResponse with text/event-stream content type","operationId":"summarize_stream_api_v1_summarize_stream_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SummarizeRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/audio/script":{"post":{"tags":["audio"],"summary":"Generate Script","description":"콘텐츠를 뉴스 스크립트로 변환합니다.\n\n- **content**: 변환할 텍스트 콘텐츠 (최소 10자)\n- **original_content**: 원본 외부 링크 콘텐츠 (선택). 있으면 content와 병합\n- **url**: 원본 URL (선택, 캐싱용)\n- **article_id**: 아티클 ID (선택, 저장용). 없으면 자동 생성\n- **user_id**: 사용자 ID (선택). 없으면 기본값 'default' 사용\n\n## 출력 스크립트 특징\n- **분량**: 3분 (약 900~1,050자)\n- **문단 수**: 8~12개 (TTS 청킹 최적화)\n- **톤**: 남성 뉴스 아나운서 스타일\n\n## 저장 경로\n- `data/users/{user_id}/audio/{article_id}_{timestamp}.json`\n\nReturns:\n    GenerateScriptResponse: 생성된 뉴스 스크립트 결과","operationId":"generate_script_api_v1_audio_script_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/GenerateScriptRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/GenerateScriptResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/audio/script/stream":{"post":{"tags":["audio"],"summary":"Generate Script Stream","description":"SSE 스트리밍으로 뉴스 스크립트를 생성합니다.\n\n## 이벤트 타입\n- **thinking**: AI의 추론 과정 텍스트\n- **content**: 스크립트 텍스트 청크\n- **done**: 최종 완료 결과 (GenerateScriptResponse와 동일한 구조)\n- **error**: 에러 발생\n\n## 이벤트 형식 (SSE)\n```\nevent: thinking\ndata: {\"text\": \"뉴스 대본 구조를 분석하고 있습니다...\"}\n\nevent: content\ndata: {\"text\": \"[제목]\\nAI가 바꾸는 미래...\"}\n\nevent: done\ndata: {\"user_id\": \"default\", \"article_id\": \"...\", \"script\": {...}, ...}\n```\n\nReturns:\n    StreamingResponse with text/event-stream content type","operationId":"generate_script_stream_api_v1_audio_script_stream_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/GenerateScriptRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/audio/synthesize":{"post":{"tags":["audio"],"summary":"Synthesize Audio","description":"저장된 스크립트를 기반으로 TTS 음성을 합성합니다.\n\n- **article_id**: 합성할 스크립트의 아티클 ID (필수)\n- **user_id**: 사용자 ID (선택). 없으면 기본값 'default' 사용\n\n## 처리 과정\n1. 저장된 스크립트 JSON 파일 로드\n2. 각 문단을 OpenAI TTS API로 음성 합성 (병렬 처리)\n3. 문단 사이에 silence padding 추가\n4. 전체 오디오 병합 후 MP3 저장\n\n## 저장 경로\n- `data/users/{user_id}/audio/{article_id}.mp3`\n\nReturns:\n    SynthesizeResponse: 생성된 오디오 파일 정보","operationId":"synthesize_audio_api_v1_audio_synthesize_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SynthesizeRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SynthesizeResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/audio/{article_id}.mp3":{"get":{"tags":["audio"],"summary":"Get Audio File","description":"생성된 오디오 파일을 스트리밍합니다.\n\n- **article_id**: 아티클 ID (path parameter)\n- **user_id**: 사용자 ID (query parameter, 기본값: 'default')\n\nReturns:\n    FileResponse: MP3 오디오 파일","operationId":"get_audio_file_api_v1_audio__article_id__mp3_get","parameters":[{"name":"article_id","in":"path","required":true,"schema":{"type":"string","title":"Article Id"}},{"name":"user_id","in":"query","required":false,"schema":{"type":"string","description":"사용자 ID","default":"default","title":"User Id"},"description":"사용자 ID"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/":{"get":{"summary":"Root","operationId":"root__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/health":{"get":{"summary":"Health Check","operationId":"health_check_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}}},"components":{"schemas":{"ArticleMetadata":{"properties":{"og_title":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Og Title","description":"OG 제목"},"og_description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Og Description","description":"OG 설명"},"og_image":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Og Image","description":"OG 이미지 URL"},"og_url":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Og Url","description":"OG URL"},"author":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Author","description":"작성자"},"published_at":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Published At","description":"게시일"},"original_url":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Original Url","description":"원본 외부 링크 (GeekNews)"},"points":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Points","description":"포인트 (GeekNews)"},"comment_count":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Comment Count","description":"댓글 수"},"read_time":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Read Time","description":"읽는 시간 (Medium)"},"claps":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Claps","description":"박수 수 (Medium)"},"tags":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Tags","description":"태그 목록"},"topic_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Topic Id","description":"토픽 ID (GeekNews)"},"subtitle":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Subtitle","description":"부제목 (Medium)"}},"additionalProperties":true,"type":"object","title":"ArticleMetadata","description":"아티클 메타데이터 스키마"},"CleanedArticle":{"properties":{"title":{"type":"string","title":"Title","description":"아티클 제목"},"cleaned_content":{"type":"string","title":"Cleaned Content","description":"정제된 텍스트 콘텐츠"},"preview_text":{"type":"string","title":"Preview Text","description":"미리보기 텍스트 (앞 300자)"},"url":{"type":"string","title":"Url","description":"원본 URL"},"platform":{"type":"string","title":"Platform","description":"플랫폼 식별자"},"crawled_at":{"type":"string","format":"date-time","title":"Crawled At"},"metadata":{"$ref":"#/components/schemas/ArticleMetadata","description":"메타데이터"},"original_content":{"type":"string","title":"Original Content","description":"원본 외부 링크의 정제된 콘텐츠","default":""}},"type":"object","required":["title","cleaned_content","preview_text","url","platform","metadata"],"title":"CleanedArticle","description":"ETL 후 정제된 결과 스키마 - API 응답용"},"CrawlErrorResponse":{"properties":{"error_code":{"type":"string","title":"Error Code","description":"에러 코드"},"message":{"type":"string","title":"Message","description":"사용자 친화적 에러 메시지"},"detail":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Detail","description":"개발자용 상세 정보"}},"type":"object","required":["error_code","message"],"title":"CrawlErrorResponse","description":"크롤링 에러 응답 스키마"},"CrawlRequest":{"properties":{"url":{"type":"string","maxLength":2083,"minLength":1,"format":"uri","title":"Url","description":"크롤링할 URL"},"user_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"User Id","description":"사용자 ID (선택). 없으면 기본값 'default' 사용"}},"type":"object","required":["url"],"title":"CrawlRequest","description":"크롤링 요청 스키마"},"GenerateScriptRequest":{"properties":{"content":{"type":"string","minLength":10,"title":"Content","description":"스크립트로 변환할 콘텐츠 텍스트"},"original_content":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Original Content","description":"원본 외부 링크 콘텐츠 (GeekNews 등). 있으면 content와 병합하여 스크립트 생성"},"url":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Url","description":"원본 URL (캐싱용, 선택)"},"article_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Article Id","description":"아티클 ID (저장용, 선택). 없으면 URL 또는 content 해시 기반 자동 생성"},"user_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"User Id","description":"사용자 ID (선택). 없으면 기본값 'default' 사용"}},"type":"object","required":["content"],"title":"GenerateScriptRequest","description":"스크립트 생성 요청 스키마"},"GenerateScriptResponse":{"properties":{"user_id":{"type":"string","title":"User Id","description":"사용자 ID"},"article_id":{"type":"string","title":"Article Id","description":"아티클 ID"},"script":{"$ref":"#/components/schemas/NewsScript","description":"생성된 뉴스 스크립트 (paragraphs, title, estimated_duration_sec, total_characters)"},"model":{"type":"string","title":"Model","description":"사용된 모델 이름"},"processing_time_ms":{"type":"integer","title":"Processing Time Ms","description":"처리 시간 (밀리초)"},"saved_path":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Saved Path","description":"저장된 파일 경로 (저장 실패 시 None)"}},"type":"object","required":["user_id","article_id","script","model","processing_time_ms"],"title":"GenerateScriptResponse","description":"스크립트 생성 응답 스키마"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"NewsScript":{"properties":{"paragraphs":{"items":{"type":"string"},"type":"array","maxItems":20,"minItems":1,"title":"Paragraphs","description":"문단별 스크립트 (목표: 8~12개, TTS 청킹용). 각 문단은 80~120자 권장"},"title":{"type":"string","title":"Title","description":"뉴스 헤드라인 제목"},"estimated_duration_sec":{"type":"integer","maximum":600.0,"minimum":30.0,"title":"Estimated Duration Sec","description":"예상 분량 (초). 목표: 180초 (3분)"},"total_characters":{"type":"integer","maximum":5000.0,"minimum":100.0,"title":"Total Characters","description":"총 글자 수. 목표: 900~1,050자 (3분 분량)"}},"type":"object","required":["paragraphs","title","estimated_duration_sec","total_characters"],"title":"NewsScript","description":"뉴스 스크립트 스키마 - LLM Structured Output용"},"SummarizeRequest":{"properties":{"content":{"type":"string","minLength":10,"title":"Content","description":"요약할 콘텐츠 텍스트"},"original_content":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Original Content","description":"원본 외부 링크 콘텐츠 (GeekNews 등). 있으면 content와 병합하여 요약"},"url":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Url","description":"원본 URL (캐싱용, 선택)"},"article_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Article Id","description":"아티클 ID (저장용, 선택). 없으면 URL 또는 content 해시 기반 자동 생성"},"user_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"User Id","description":"사용자 ID (선택). 없으면 기본값 'default' 사용"}},"type":"object","required":["content"],"title":"SummarizeRequest","description":"요약 요청 스키마"},"SummarizeResponse":{"properties":{"bullet_points":{"items":{"type":"string"},"type":"array","title":"Bullet Points","description":"핵심 포인트 요약 (3-5개)"},"main_topic":{"type":"string","title":"Main Topic","description":"주요 주제 한 줄 요약"},"model":{"type":"string","title":"Model","description":"사용된 모델 이름"},"processing_time_ms":{"type":"integer","title":"Processing Time Ms","description":"처리 시간 (밀리초)"},"article_id":{"type":"string","title":"Article Id","description":"아티클 ID"},"saved_path":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Saved Path","description":"저장된 파일 경로 (저장 실패 시 None)"}},"type":"object","required":["bullet_points","main_topic","model","processing_time_ms","article_id"],"title":"SummarizeResponse","description":"요약 응답 스키마"},"SynthesizeRequest":{"properties":{"article_id":{"type":"string","title":"Article Id","description":"합성할 스크립트의 아티클 ID"},"user_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"User Id","description":"사용자 ID (선택). 없으면 기본값 'default' 사용"}},"type":"object","required":["article_id"],"title":"SynthesizeRequest","description":"TTS 합성 요청 스키마"},"SynthesizeResponse":{"properties":{"audio_url":{"type":"string","title":"Audio Url","description":"생성된 오디오 파일 URL (/api/v1/audio/{article_id}.mp3)"},"duration_seconds":{"type":"number","title":"Duration Seconds","description":"오디오 길이 (초)"},"file_size_bytes":{"type":"integer","title":"File Size Bytes","description":"파일 크기 (바이트)"},"user_id":{"type":"string","title":"User Id","description":"사용자 ID"},"article_id":{"type":"string","title":"Article Id","description":"아티클 ID"},"processing_time_ms":{"type":"integer","title":"Processing Time Ms","description":"처리 시간 (밀리초)"}},"type":"object","required":["audio_url","duration_seconds","file_size_bytes","user_id","article_id","processing_time_ms"],"title":"SynthesizeResponse","description":"TTS 합성 응답 스키마"},"UrlSupportResponse":{"properties":{"url":{"type":"string","title":"Url","description":"확인한 URL"},"is_supported":{"type":"boolean","title":"Is Supported","description":"지원 여부"},"platform":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Platform","description":"플랫폼 이름 (geeknews, medium, generic)"},"is_specialized":{"type":"boolean","title":"Is Specialized","description":"전용 크롤러 사용 여부","default":false},"domain":{"type":"string","title":"Domain","description":"파싱된 도메인","default":""},"error_code":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error Code","description":"지원하지 않는 경우 에러 코드"},"error_message":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error Message","description":"지원하지 않는 경우 에러 메시지"}},"type":"object","required":["url","is_supported"],"title":"UrlSupportResponse","description":"URL 지원 여부 응답 스키마"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}}}}