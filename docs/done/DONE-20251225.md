# ê°œë°œ ì™„ë£Œ ì´ë ¥ - 2025-12-25

> OpenAI TTS API ì—°ë™ ë° ì‹¤ì œ ì˜¤ë””ì˜¤ ì¬ìƒ ê¸°ëŠ¥ êµ¬í˜„ (Phase 3 ì™„ë£Œ)
> **ë²”ìš© í¬ë¡¤ëŸ¬ (GenericCrawler) ë° ì…ë ¥ ê²€ì¦ ì‹œìŠ¤í…œ êµ¬í˜„ (Phase 5 ì™„ë£Œ)**

---

## Phase 3: AI ì„œë¹„ìŠ¤ êµ¬í˜„ (ê³„ì†)

### TTS ìŒì„± í•©ì„± êµ¬í˜„ (Step 2) âœ…

Step 1ì—ì„œ ìƒì„±ëœ ë‰´ìŠ¤ ìŠ¤í¬ë¦½íŠ¸ë¥¼ OpenAI TTS APIë¥¼ í†µí•´ ì‹¤ì œ ìŒì„± íŒŒì¼ë¡œ í•©ì„±í•˜ëŠ” ê¸°ëŠ¥ì„ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.

- [x] OpenAI TTS API ì—°ë™ (`openai` SDK, `gpt-4o-mini-tts` ëª¨ë¸)
- [x] ë¬¸ë‹¨ë³„ TTS ë³‘ë ¬ í•©ì„± (`asyncio.gather`)
- [x] `pydub` ê¸°ë°˜ ì˜¤ë””ì˜¤ ì²­í¬ ë³‘í•© + silence padding
- [x] MP3 íŒŒì¼ ì €ì¥: `backend/data/users/{user_id}/audio/{article_id}.mp3`
- [x] `POST /api/v1/audio/synthesize` ì—”ë“œí¬ì¸íŠ¸ ì¶”ê°€
- [x] `GET /api/v1/audio/{article_id}.mp3` íŒŒì¼ ì„œë¹™ ì—”ë“œí¬ì¸íŠ¸ ì¶”ê°€
- [x] Frontend AudioPlayerCardì—ì„œ ì‹¤ì œ ì˜¤ë””ì˜¤ ì¬ìƒ ê¸°ëŠ¥ êµ¬í˜„
- [x] ë‹¤ìš´ë¡œë“œ ê¸°ëŠ¥ êµ¬í˜„

**ìˆ˜ì •ëœ íŒŒì¼:**

| íŒŒì¼                                       | ë³€ê²½ ë‚´ìš©                                                                  |
| ------------------------------------------ | -------------------------------------------------------------------------- |
| `backend/pyproject.toml`                   | `pydub>=0.25.1` ì˜ì¡´ì„± ì¶”ê°€                                                |
| `backend/app/core/config.py`               | OpenAI TTS ì„¤ì • ì¶”ê°€ (API KEY, ëª¨ë¸, ìŒì„±, silence padding ë“±)             |
| `backend/app/services/audio.py`            | TTS ë©”ì„œë“œ ì¶”ê°€ (`_call_openai_tts`, `_merge_audio_chunks`, `synthesize_speech`) |
| `backend/app/api/v1/audio.py`              | `POST /synthesize`, `GET /{article_id}.mp3` ì—”ë“œí¬ì¸íŠ¸, ìŠ¤í‚¤ë§ˆ ì¶”ê°€        |
| `frontend/lib/api.ts`                      | `SynthesizeRequest/Response` íƒ€ì…, `synthesizeAudio()`, `getAudioUrl()` í•¨ìˆ˜ |
| `frontend/components/audio-player-card.tsx` | ì‹¤ì œ `<audio>` ì¬ìƒ, ì‹œí‚¹, ë‹¤ìš´ë¡œë“œ ê¸°ëŠ¥                                   |
| `frontend/components/content-panel.tsx`    | `audioUrl`, `audioDuration` props ì „ë‹¬                                     |
| `frontend/app/page.tsx`                    | `synthesizing` ìƒíƒœ, TTS íŒŒì´í”„ë¼ì¸ í†µí•©                                   |

**í•µì‹¬ êµ¬í˜„ ì½”ë“œ:**

```python
# backend/app/core/config.py - TTS ì„¤ì •
class Settings(BaseSettings):
    # ===== OpenAI TTS (ìŒì„± í•©ì„±) ì„¤ì • =====
    OPENAI_API_KEY: str = ""
    TTS_MODEL: str = "gpt-4o-mini-tts"
    TTS_VOICE: str = "marin"  # ê¶Œì¥ ìŒì„±
    TTS_SILENCE_PADDING_MS: int = 500  # ë¬¸ë‹¨ ì‚¬ì´ silence
    TTS_INSTRUCTIONS: str = "ì°¨ë¶„í•˜ê³  ì „ë¬¸ì ì¸ í•œêµ­ì–´ ë‰´ìŠ¤ ì•„ë‚˜ìš´ì„œ í†¤..."
```

```python
# backend/app/services/audio.py - TTS í•µì‹¬ ë©”ì„œë“œ
class AudioService:
    async def _call_openai_tts(self, text: str) -> bytes:
        """ë‹¨ì¼ ë¬¸ë‹¨ì„ OpenAI TTS APIë¡œ í•©ì„±"""
        response = await self.openai_client.audio.speech.create(
            model=self.tts_model,
            voice=self.tts_voice,
            input=text,
            response_format="mp3",
        )
        return response.content

    def _merge_audio_chunks(self, audio_chunks: list[bytes]) -> tuple[bytes, float]:
        """ì˜¤ë””ì˜¤ ì²­í¬ë¥¼ silence paddingê³¼ í•¨ê»˜ ë³‘í•© (pydub)"""
        combined = AudioSegment.empty()
        silence = AudioSegment.silent(duration=self.tts_silence_padding_ms)

        for i, chunk in enumerate(audio_chunks):
            segment = AudioSegment.from_mp3(io.BytesIO(chunk))
            combined += segment
            if i < len(audio_chunks) - 1:
                combined += silence

        # MP3 ë°”ì´íŠ¸ë¡œ ë‚´ë³´ë‚´ê¸°
        buffer = io.BytesIO()
        combined.export(buffer, format="mp3")
        return buffer.getvalue(), combined.duration_seconds

    async def synthesize_speech(
        self, script: NewsScript, article_id: str, user_id: str, ...
    ) -> dict:
        """ë‰´ìŠ¤ ìŠ¤í¬ë¦½íŠ¸ ì „ì²´ë¥¼ ìŒì„±ìœ¼ë¡œ í•©ì„±"""
        # 1. ê° ë¬¸ë‹¨ì„ ë³‘ë ¬ë¡œ TTS í•©ì„±
        tasks = [self._call_openai_tts(p) for p in script.paragraphs]
        audio_chunks = await asyncio.gather(*tasks)

        # 2. ì˜¤ë””ì˜¤ ë³‘í•©
        merged_audio, duration_sec = self._merge_audio_chunks(list(audio_chunks))

        # 3. MP3 ì €ì¥
        audio_path = save_dir / f"{article_id}.mp3"
        with open(audio_path, "wb") as f:
            f.write(merged_audio)

        return {
            "audio_path": audio_path,
            "duration_sec": duration_sec,
            "file_size_bytes": len(merged_audio),
        }
```

```typescript
// frontend/lib/api.ts - TTS API í´ë¼ì´ì–¸íŠ¸
export interface SynthesizeRequest {
  article_id: string;
  user_id?: string;
}

export interface SynthesizeResponse {
  audio_url: string;
  duration_seconds: number;
  file_size_bytes: number;
  // ...
}

export async function synthesizeAudio(
  request: SynthesizeRequest
): Promise<SynthesizeResponse> {
  const response = await fetch(`${API_BASE}/api/v1/audio/synthesize`, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(request),
  });
  return response.json();
}

export function getAudioUrl(articleId: string, userId: string = DEFAULT_USER_ID): string {
  return `${API_BASE}/api/v1/audio/${articleId}.mp3?user_id=${userId}`;
}
```

**API ìš”ì²­/ì‘ë‹µ:**

```bash
# TTS í•©ì„± API
POST /api/v1/audio/synthesize
{
  "article_id": "topic_25115",
  "user_id": "default"
}

Response:
{
  "audio_url": "/api/v1/audio/topic_25115.mp3?user_id=default",
  "duration_seconds": 145.5,
  "file_size_bytes": 2332800,
  "user_id": "default",
  "article_id": "topic_25115",
  "processing_time_ms": 12345
}

# ì˜¤ë””ì˜¤ íŒŒì¼ ì„œë¹™
GET /api/v1/audio/{article_id}.mp3?user_id=default

Response: audio/mpeg (MP3 íŒŒì¼)
```

**ì²˜ë¦¬ íŒŒì´í”„ë¼ì¸ (ìµœì¢…):**

```
[POST /api/v1/crawl]
       â”‚
       â–¼
[CrawledArticle] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚                                                â”‚
       â–¼                                                â–¼
[POST /api/v1/summarize/stream]         [POST /api/v1/audio/script/stream]
       â”‚ (SSE ìŠ¤íŠ¸ë¦¬ë°)                          â”‚ (SSE ìŠ¤íŠ¸ë¦¬ë°)
       â–¼                                                â–¼
   [Summary]                                    [NewsScript]
       â”‚                                                â”‚
       â”‚                                                â–¼
       â”‚                              [POST /api/v1/audio/synthesize] âœ…
       â”‚                                                â”‚
       â”‚                                                â–¼
       â”‚                                     [GET /{article_id}.mp3] âœ…
       â”‚                                                â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â–¼
                [Frontend Display]
                - InsightCard (ìš”ì•½)
                - AudioPlayerCard (ìŠ¤í¬ë¦½íŠ¸ + ì˜¤ë””ì˜¤ ì¬ìƒ) âœ…
```

**Frontend ì˜¤ë””ì˜¤ í”Œë ˆì´ì–´:**

- ì‹¤ì œ `<audio>` ìš”ì†Œ ê¸°ë°˜ ì¬ìƒ
- ì¬ìƒ/ì¼ì‹œì •ì§€ ë²„íŠ¼
- í”„ë¡œê·¸ë ˆìŠ¤ ë°” (ì‹œí‚¹ ì§€ì›)
- í˜„ì¬ ì‹œê°„ / ì´ ì‹œê°„ í‘œì‹œ
- ë‹¤ìš´ë¡œë“œ ë²„íŠ¼ (`<a download>`)

---

## ì„¤ê³„ ê²°ì • ê¸°ë¡ (ADR)

### ADR-018: OpenAI TTS API ì„ íƒ

| í•­ëª©     | ë‚´ìš©                                                                            |
| -------- | ------------------------------------------------------------------------------- |
| **ê²°ì •** | OpenAI TTS API (`gpt-4o-mini-tts` ëª¨ë¸) ì‚¬ìš©                                    |
| **ì´ìœ ** | í•œêµ­ì–´ í’ˆì§ˆ ìš°ìˆ˜, ìµœì‹  ëª¨ë¸ë¡œ ìì—°ìŠ¤ëŸ¬ìš´ ë°œìŒ, API ì‚¬ìš© ê°„í¸                    |
| **ëŒ€ì•ˆ** | Google Cloud TTS, ElevenLabs, Coqui TTS (ë¡œì»¬)                                  |
| **ê²°ê³¼** | ê³ í’ˆì§ˆ í•œêµ­ì–´ ë‰´ìŠ¤ ì•„ë‚˜ìš´ì„œ í†¤ì˜ ìŒì„± í•©ì„± ê°€ëŠ¥, `marin` ë³´ì´ìŠ¤ ê¸°ë³¸ ì‚¬ìš©       |

### ADR-019: ë¬¸ë‹¨ë³„ ë³‘ë ¬ TTS í•©ì„±

| í•­ëª©     | ë‚´ìš©                                                                            |
| -------- | ------------------------------------------------------------------------------- |
| **ê²°ì •** | ë¬¸ë‹¨ë³„ë¡œ TTS APIë¥¼ ë³‘ë ¬ í˜¸ì¶œ í›„ ë³‘í•© (`asyncio.gather`)                         |
| **ì´ìœ ** | ì „ì²´ ìŠ¤í¬ë¦½íŠ¸ë¥¼ í•œ ë²ˆì— ë³´ë‚´ë©´ API ì œí•œì— ê±¸ë¦´ ìˆ˜ ìˆìŒ, ë³‘ë ¬ ì²˜ë¦¬ë¡œ ì†ë„ í–¥ìƒ   |
| **ëŒ€ì•ˆ** | ì „ì²´ í…ìŠ¤íŠ¸ ë‹¨ì¼ í˜¸ì¶œ, ìˆœì°¨ ì²˜ë¦¬                                                |
| **ê²°ê³¼** | 8~12ê°œ ë¬¸ë‹¨ì„ ë™ì‹œì— í•©ì„±í•˜ì—¬ ì²˜ë¦¬ ì‹œê°„ ë‹¨ì¶•, silence paddingìœ¼ë¡œ ìì—°ìŠ¤ëŸ¬ìš´ ì‰¼ |

### ADR-020: pydub ê¸°ë°˜ ì˜¤ë””ì˜¤ ë³‘í•©

| í•­ëª©     | ë‚´ìš©                                                                            |
| -------- | ------------------------------------------------------------------------------- |
| **ê²°ì •** | `pydub` ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ ì˜¤ë””ì˜¤ ì²­í¬ ë³‘í•© ë° silence padding                        |
| **ì´ìœ ** | íŒŒì´ì¬ì—ì„œ ê°„í¸í•œ ì˜¤ë””ì˜¤ ì²˜ë¦¬, MP3 í¬ë§· ì§€ì›, ë„ë¦¬ ì‚¬ìš©ë˜ëŠ” ì•ˆì •ì ì¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ |
| **ëŒ€ì•ˆ** | ffmpeg ì§ì ‘ í˜¸ì¶œ, AudioSegment ì™¸ ë‹¤ë¥¸ ë¼ì´ë¸ŒëŸ¬ë¦¬                               |
| **ê²°ê³¼** | ë¬¸ë‹¨ ì‚¬ì´ 500ms silence ì¶”ê°€ë¡œ ìì—°ìŠ¤ëŸ¬ìš´ í˜¸í¡, ë‹¨ì¼ MP3 íŒŒì¼ ì¶œë ¥              |

---

## Phase 3-2 ì™„ë£Œ ìƒíƒœ ìš”ì•½

| Step   | ë‚´ìš©               | ìƒíƒœ   | ì™„ë£Œì¼     |
| ------ | ------------------ | ------ | ---------- |
| Step 1 | ëŒ€ë³¸ ìƒì„± (Gemini) | âœ… ì™„ë£Œ | 2025-12-23 |
| Step 2 | TTS ìŒì„± í•©ì„±      | âœ… ì™„ë£Œ | 2025-12-25 |

**Phase 3 ì˜¤ë””ì˜¤ ì„œë¹„ìŠ¤ ì „ì²´ ì™„ë£Œ! ğŸ‰**

---

## í™˜ê²½ ë³€ìˆ˜ ì¶”ê°€ ì‚¬í•­

`.env` íŒŒì¼ì— ë‹¤ìŒ ì„¤ì • ì¶”ê°€ í•„ìš”:

```env
# OpenAI TTS API í‚¤
OPENAI_API_KEY=sk-...

# TTS ì„¤ì • (ì„ íƒ, ê¸°ë³¸ê°’ ìˆìŒ)
TTS_MODEL=gpt-4o-mini-tts
TTS_VOICE=marin
TTS_SILENCE_PADDING_MS=500
```

---

## Phase 5: í¬ë¡¤ëŸ¬ í™•ì¥ & ì…ë ¥ ê²€ì¦ âœ…

### 5-1. GenericCrawler êµ¬í˜„ âœ…

trafilatura ê¸°ë°˜ì˜ ë²”ìš© í¬ë¡¤ëŸ¬ë¥¼ êµ¬í˜„í•˜ì—¬ íŠ¹ì • í”Œë«í¼ ì „ìš© í¬ë¡¤ëŸ¬ê°€ ì—†ëŠ” ì›¹ì‚¬ì´íŠ¸ë„ í¬ë¡¤ë§í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.

- [x] `backend/app/services/crawlers/generic.py` ìƒì„±
- [x] trafilatura ê¸°ë°˜ ì½˜í…ì¸  ì¶”ì¶œ (`target_language="ko"`, `favor_recall=True`)
- [x] BeautifulSoup fallback ë¡œì§ (`article`, `main`, `.post-content` ë“± ì…€ë ‰í„°)
- [x] OG ë©”íƒ€ íƒœê·¸ ë° HTML ë©”íƒ€ íƒœê·¸ì—ì„œ ë©”íƒ€ë°ì´í„° ì¶”ì¶œ
- [x] ë¹„í…ìŠ¤íŠ¸ ì½˜í…ì¸  í”Œë«í¼ ì œì™¸ (YouTube, Twitter, Instagram)

**ìˆ˜ì •ëœ íŒŒì¼:**

| íŒŒì¼ | ë³€ê²½ ë‚´ìš© |
|------|----------|
| `backend/app/services/crawlers/generic.py` | GenericCrawler í´ë˜ìŠ¤ ì‹ ê·œ ìƒì„± |
| `backend/app/services/crawlers/__init__.py` | GenericCrawler export ì¶”ê°€ |

**í•µì‹¬ êµ¬í˜„ ì½”ë“œ:**

```python
# backend/app/services/crawlers/generic.py
class GenericCrawler(BaseCrawler):
    """ë²”ìš© ì›¹ í¬ë¡¤ëŸ¬ - trafilatura ê¸°ë°˜"""
    
    # ì§€ì›í•˜ì§€ ì•ŠëŠ” í”Œë«í¼ (ë¹„í…ìŠ¤íŠ¸ ì½˜í…ì¸ )
    UNSUPPORTED_DOMAINS = [
        "youtube.com", "youtu.be",
        "twitter.com", "x.com",
        "instagram.com",
        "tiktok.com",
        "facebook.com",
    ]
    
    def _extract_content(self, html: str) -> str | None:
        """trafilaturaë¡œ ì½˜í…ì¸  ì¶”ì¶œ"""
        content = trafilatura.extract(
            html,
            target_language="ko",
            favor_recall=True,
            include_comments=False,
        )
        if content and len(content) >= 50:
            return content
        return self._extract_content_fallback(html)
    
    def _extract_content_fallback(self, html: str) -> str | None:
        """BeautifulSoup fallback"""
        soup = BeautifulSoup(html, "lxml")
        selectors = ["article", "main", ".post-content", ".article-content", "#content"]
        for selector in selectors:
            element = soup.select_one(selector)
            if element:
                text = element.get_text(separator="\n", strip=True)
                if len(text) >= 50:
                    return text
        return None
```

### 5-2. CrawlerFactory í™•ì¥ âœ…

GenericCrawlerë¥¼ fallbackìœ¼ë¡œ ë“±ë¡í•˜ê³ , í”Œë«í¼ ê°ì§€ ê¸°ëŠ¥ì„ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤.

- [x] `get_crawler()` ë©”ì„œë“œì— fallback ë¡œì§ ì¶”ê°€
- [x] `detect_platform()` ë©”ì„œë“œ ì¶”ê°€ (í”Œë«í¼ ì •ë³´ + ì—ëŸ¬ ì½”ë“œ ë°˜í™˜)
- [x] `is_supported()` ë©”ì„œë“œì— `include_generic` íŒŒë¼ë¯¸í„° ì¶”ê°€

**ìˆ˜ì •ëœ íŒŒì¼:**

| íŒŒì¼ | ë³€ê²½ ë‚´ìš© |
|------|----------|
| `backend/app/services/crawlers/factory.py` | GenericCrawler fallback, detect_platform() ì¶”ê°€ |

**í•µì‹¬ êµ¬í˜„ ì½”ë“œ:**

```python
# backend/app/services/crawlers/factory.py
class CrawlerFactory:
    @classmethod
    def get_crawler(cls, url: str) -> BaseCrawler:
        """URLì— ë§ëŠ” í¬ë¡¤ëŸ¬ ë°˜í™˜ (ì—†ìœ¼ë©´ GenericCrawler)"""
        for domain, crawler_cls in cls._crawlers.items():
            if domain in url:
                return crawler_cls()
        return GenericCrawler()  # fallback
    
    @classmethod
    def detect_platform(cls, url: str) -> dict:
        """í”Œë«í¼ ê°ì§€ ë° ìƒì„¸ ì •ë³´ ë°˜í™˜"""
        # GenericCrawlerê°€ ì§€ì›í•˜ì§€ ì•ŠëŠ” ë„ë©”ì¸ ì²´í¬
        for domain in GenericCrawler.UNSUPPORTED_DOMAINS:
            if domain in url:
                return {
                    "platform": None,
                    "is_specialized": False,
                    "domain": domain,
                    "error_code": "UNSUPPORTED_CONTENT",
                    "error_message": ERROR_MESSAGES["UNSUPPORTED_CONTENT"],
                }
        # ì „ìš© í¬ë¡¤ëŸ¬ í™•ì¸
        for domain, crawler_cls in cls._crawlers.items():
            if domain in url:
                return {
                    "platform": crawler_cls.platform_name,
                    "is_specialized": True,
                    "domain": domain,
                }
        # GenericCrawler ì‚¬ìš©
        return {
            "platform": "generic",
            "is_specialized": False,
            "domain": urlparse(url).netloc,
        }
```

### 5-3. ì—ëŸ¬ í•¸ë“¤ë§ ì‹œìŠ¤í…œ âœ…

ì„¸ë¶„í™”ëœ ì—ëŸ¬ íƒ€ì…ê³¼ ì‚¬ìš©ì ì¹œí™”ì  ë©”ì‹œì§€ ì‹œìŠ¤í…œì„ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.

- [x] `backend/app/services/crawlers/errors.py` ìƒì„±
- [x] ì»¤ìŠ¤í…€ ì˜ˆì™¸ í´ë˜ìŠ¤ ì •ì˜ (HTTPException ìƒì†)
- [x] ì—ëŸ¬ ì½”ë“œë³„ í•œêµ­ì–´ ë©”ì‹œì§€ ì •ì˜
- [x] API ì—”ë“œí¬ì¸íŠ¸ì— ì—ëŸ¬ í•¸ë“¤ë§ ì ìš©

**ìˆ˜ì •ëœ íŒŒì¼:**

| íŒŒì¼ | ë³€ê²½ ë‚´ìš© |
|------|----------|
| `backend/app/services/crawlers/errors.py` | ì—ëŸ¬ íƒ€ì… ë° ë©”ì‹œì§€ ì •ì˜ |
| `backend/app/api/v1/crawl.py` | ì—ëŸ¬ í•¸ë“¤ë§ ë¡œì§ ì ìš©, check-support ì—”ë“œí¬ì¸íŠ¸ ê°œì„  |

**ì—ëŸ¬ íƒ€ì… ì •ì˜:**

| ì—ëŸ¬ ì½”ë“œ | HTTP ìƒíƒœ | ì„¤ëª… |
|----------|----------|------|
| `INVALID_URL_FORMAT` | 400 | ìœ íš¨í•˜ì§€ ì•Šì€ URL í˜•ì‹ |
| `EMPTY_INPUT` | 400 | URLì´ ë¹„ì–´ìˆìŒ |
| `UNSUPPORTED_CONTENT` | 415 | ì§€ì›í•˜ì§€ ì•ŠëŠ” ì½˜í…ì¸  íƒ€ì… (YouTube ë“±) |
| `NO_CONTENT` | 422 | ì½˜í…ì¸  ì¶”ì¶œ ì‹¤íŒ¨ |
| `CRAWL_FAILED` | 502 | í¬ë¡¤ë§ ì¤‘ ì˜¤ë¥˜ ë°œìƒ |
| `TIMEOUT` | 504 | ìš”ì²­ ì‹œê°„ ì´ˆê³¼ |

**í•µì‹¬ êµ¬í˜„ ì½”ë“œ:**

```python
# backend/app/services/crawlers/errors.py
ERROR_MESSAGES = {
    "INVALID_URL_FORMAT": "ìœ íš¨í•˜ì§€ ì•Šì€ URL í˜•ì‹ì…ë‹ˆë‹¤. http:// ë˜ëŠ” https://ë¡œ ì‹œì‘í•˜ëŠ” URLì„ ì…ë ¥í•´ì£¼ì„¸ìš”.",
    "EMPTY_INPUT": "URLì„ ì…ë ¥í•´ì£¼ì„¸ìš”.",
    "UNSUPPORTED_CONTENT": "ì´ í”Œë«í¼ì€ í…ìŠ¤íŠ¸ ì½˜í…ì¸ ë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. (YouTube, Twitter ë“±)",
    "NO_CONTENT": "í˜ì´ì§€ì—ì„œ ì½˜í…ì¸ ë¥¼ ì¶”ì¶œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.",
    "CRAWL_FAILED": "í¬ë¡¤ë§ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.",
    "TIMEOUT": "ìš”ì²­ ì‹œê°„ì´ ì´ˆê³¼ë˜ì—ˆìŠµë‹ˆë‹¤. ë„¤íŠ¸ì›Œí¬ ìƒíƒœë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.",
}

class CrawlError(HTTPException):
    """í¬ë¡¤ë§ ì—ëŸ¬ ê¸°ë³¸ í´ë˜ìŠ¤"""
    def __init__(self, error_code: str, status_code: int = 400):
        self.error_code = error_code
        super().__init__(
            status_code=status_code,
            detail={"error_code": error_code, "message": ERROR_MESSAGES.get(error_code, "")}
        )

class UnsupportedContentError(CrawlError):
    def __init__(self):
        super().__init__("UNSUPPORTED_CONTENT", status_code=415)
```

### 5-4. Frontend ì…ë ¥ ê²€ì¦ UI âœ…

ì‹¤ì‹œê°„ URL ê²€ì¦ ë° ì—ëŸ¬ í‘œì‹œ UIë¥¼ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.

- [x] `checkUrlSupport()` API í•¨ìˆ˜ ì¶”ê°€
- [x] ë””ë°”ìš´ìŠ¤ ì ìš© (300ms)
- [x] ê²€ì¦ ìƒíƒœë³„ UI (ìœ íš¨/ë¬´íš¨/ê²€ì¦ì¤‘)
- [x] í”Œë«í¼ ê°ì§€ ê²°ê³¼ í‘œì‹œ

**ìˆ˜ì •ëœ íŒŒì¼:**

| íŒŒì¼ | ë³€ê²½ ë‚´ìš© |
|------|----------|
| `frontend/lib/api.ts` | `checkUrlSupport()`, `UrlSupportResponse` íƒ€ì… ì¶”ê°€ |
| `frontend/components/welcome-input.tsx` | ì‹¤ì‹œê°„ ê²€ì¦ UI êµ¬í˜„ |

**í•µì‹¬ êµ¬í˜„ ì½”ë“œ:**

```typescript
// frontend/lib/api.ts
export interface UrlSupportResponse {
  is_supported: boolean;
  platform: string | null;
  is_specialized: boolean;
  domain: string;
  error_code?: string;
  error_message?: string;
}

export async function checkUrlSupport(url: string): Promise<UrlSupportResponse> {
  const response = await fetch(`${API_BASE}/api/v1/crawl/check-support?url=${encodeURIComponent(url)}`);
  return response.json();
}
```

```tsx
// frontend/components/welcome-input.tsx (ì¼ë¶€)
useEffect(() => {
  if (!url.trim()) {
    setValidationState(null);
    return;
  }
  
  const timer = setTimeout(async () => {
    setIsValidating(true);
    try {
      const result = await checkUrlSupport(url);
      setValidationState(result);
    } catch {
      setValidationState({ is_supported: false, error_message: "ê²€ì¦ ì‹¤íŒ¨" });
    } finally {
      setIsValidating(false);
    }
  }, 300);  // ë””ë°”ìš´ìŠ¤
  
  return () => clearTimeout(timer);
}, [url]);
```

**UI ìƒíƒœ:**

| ìƒíƒœ | í…Œë‘ë¦¬ ìƒ‰ìƒ | ì•„ì´ì½˜ | ë©”ì‹œì§€ |
|-----|-----------|--------|--------|
| ê²€ì¦ ì¤‘ | ê¸°ë³¸ | ìŠ¤í”¼ë„ˆ | - |
| ìœ íš¨ (ì „ìš©) | ë…¹ìƒ‰ | âœ“ | "GeekNewsë¡œ ê°ì§€ë¨" |
| ìœ íš¨ (ë²”ìš©) | ë…¹ìƒ‰ | âœ“ | "ì›¹ í˜ì´ì§€ë¡œ ì²˜ë¦¬ë©ë‹ˆë‹¤" |
| ë¬´íš¨ | ë¹¨ê°„ìƒ‰ | âš  | ì—ëŸ¬ ë©”ì‹œì§€ |

### í…ŒìŠ¤íŠ¸ ê²°ê³¼

#### 4.1 ê¸°ì¡´ í”Œë«í¼ (ì „ìš© í¬ë¡¤ëŸ¬)

| í”Œë«í¼ | URL | ê²°ê³¼ |
|--------|-----|------|
| GeekNews | `https://news.hada.io/topic?id=24268` | âœ… ì„±ê³µ (7,345ì) |
| Medium | `https://freedium.cfd/...` | âš ï¸ Freedium 404 |

#### 4.2 GenericCrawler ëŒ€ìƒ í”Œë«í¼

| í”Œë«í¼ | URL | ê²°ê³¼ |
|--------|-----|------|
| Naver News | `https://n.news.naver.com/...` | âœ… ì„±ê³µ (394ì) |
| a16z | `https://a16z.com/...` | âœ… ì„±ê³µ (14,761ì) |
| Anthropic | `https://www.anthropic.com/research/...` | âœ… ì„±ê³µ (18,948ì) |
| TuringPost | `https://www.turingpost.com/...` | âœ… ì„±ê³µ (18,911ì) |
| ì¡°ì„ ì¼ë³´ | `https://www.chosun.com/...` | âš ï¸ 404 (ë´‡ ì°¨ë‹¨) |
| í•œê²¨ë ˆ | `https://www.hani.co.kr/...` | âš ï¸ 404 (ë´‡ ì°¨ë‹¨) |

#### 4.3 ì—ëŸ¬ ì¼€ì´ìŠ¤

| ì…ë ¥ | ì˜ˆìƒ ê²°ê³¼ | ì‹¤ì œ ê²°ê³¼ |
|-----|----------|----------|
| `invalid-text` | `INVALID_URL_FORMAT` | âœ… ì¼ì¹˜ |
| (ë¹ˆ ì…ë ¥) | `EMPTY_INPUT` | âœ… ì¼ì¹˜ |
| YouTube URL | `UNSUPPORTED_CONTENT` | âœ… ì¼ì¹˜ |
| Twitter URL | `UNSUPPORTED_CONTENT` | âœ… ì¼ì¹˜ |
| Instagram URL | `UNSUPPORTED_CONTENT` | âœ… ì¼ì¹˜ |

---

## ì„¤ê³„ ê²°ì • ê¸°ë¡ (ADR) - Phase 5

### ADR-021: GenericCrawler ì•„í‚¤í…ì²˜

| í•­ëª©     | ë‚´ìš©                                                                            |
| -------- | ------------------------------------------------------------------------------- |
| **ê²°ì •** | trafilaturaë¥¼ ê¸°ë³¸ìœ¼ë¡œ ì‚¬ìš©í•˜ê³ , BeautifulSoupì„ fallbackìœ¼ë¡œ êµ¬í˜„              |
| **ì´ìœ ** | trafilaturaëŠ” ë‹¤ì–‘í•œ ì‚¬ì´íŠ¸ì—ì„œ ë³¸ë¬¸ ì¶”ì¶œ ì •í™•ë„ê°€ ë†’ì§€ë§Œ, ì¼ë¶€ ì‚¬ì´íŠ¸ ì‹¤íŒ¨ ê°€ëŠ¥ |
| **ëŒ€ì•ˆ** | newspaper3k, readability-lxml, Playwright (ë™ì  ë Œë”ë§)                         |
| **ê²°ê³¼** | ëŒ€ë¶€ë¶„ì˜ ì •ì  ì›¹í˜ì´ì§€ì—ì„œ ì•ˆì •ì ì¸ ì½˜í…ì¸  ì¶”ì¶œ ê°€ëŠ¥                             |

### ADR-022: ë¹„í…ìŠ¤íŠ¸ í”Œë«í¼ ëª…ì‹œì  ì œì™¸

| í•­ëª©     | ë‚´ìš©                                                                            |
| -------- | ------------------------------------------------------------------------------- |
| **ê²°ì •** | YouTube, Twitter, Instagram ë“± ë©€í‹°ë¯¸ë””ì–´ í”Œë«í¼ì„ URL ë‹¨ê³„ì—ì„œ ì°¨ë‹¨            |
| **ì´ìœ ** | í…ìŠ¤íŠ¸ ì½˜í…ì¸  ì¶”ì¶œì´ ë¶ˆê°€ëŠ¥í•˜ê±°ë‚˜ ì˜ë¯¸ ì—†ëŠ” ê²°ê³¼ ë°˜í™˜ ë°©ì§€                       |
| **ëŒ€ì•ˆ** | í¬ë¡¤ë§ ì‹œë„ í›„ ì‹¤íŒ¨ ì²˜ë¦¬                                                        |
| **ê²°ê³¼** | ì‚¬ìš©ìì—ê²Œ ì¦‰ê°ì ì¸ í”¼ë“œë°± ì œê³µ, ë¶ˆí•„ìš”í•œ API í˜¸ì¶œ ë°©ì§€                          |

### ADR-023: ì—ëŸ¬ ì½”ë“œ ê¸°ë°˜ ì—ëŸ¬ í•¸ë“¤ë§

| í•­ëª©     | ë‚´ìš©                                                                            |
| -------- | ------------------------------------------------------------------------------- |
| **ê²°ì •** | ë¬¸ìì—´ ì—ëŸ¬ ì½”ë“œ + í•œêµ­ì–´ ë©”ì‹œì§€ ë§¤í•‘ ë°©ì‹                                       |
| **ì´ìœ ** | í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ì—ëŸ¬ ì½”ë“œë¡œ ì¡°ê±´ ë¶„ê¸°, ì‚¬ìš©ìì—ê²Œ ì¹œìˆ™í•œ ë©”ì‹œì§€ í‘œì‹œ              |
| **ëŒ€ì•ˆ** | HTTP ìƒíƒœ ì½”ë“œë§Œ ì‚¬ìš©, enum ê¸°ë°˜ ì—ëŸ¬ ì½”ë“œ                                       |
| **ê²°ê³¼** | ë°±ì—”ë“œ-í”„ë¡ íŠ¸ì—”ë“œ ê°„ ëª…í™•í•œ ì—ëŸ¬ ê³„ì•½, ë‹¤êµ­ì–´ ì§€ì› ìš©ì´                          |

### ADR-024: í”„ë¡ íŠ¸ì—”ë“œ ë””ë°”ìš´ìŠ¤ ê²€ì¦

| í•­ëª©     | ë‚´ìš©                                                                            |
| -------- | ------------------------------------------------------------------------------- |
| **ê²°ì •** | 300ms ë””ë°”ìš´ìŠ¤ë¡œ URL ì…ë ¥ ê²€ì¦ API í˜¸ì¶œ                                         |
| **ì´ìœ ** | ë§¤ í‚¤ ì…ë ¥ë§ˆë‹¤ API í˜¸ì¶œ ë°©ì§€, ì„œë²„ ë¶€í•˜ ê°ì†Œ                                    |
| **ëŒ€ì•ˆ** | ë¸”ëŸ¬ ì´ë²¤íŠ¸ì—ì„œë§Œ ê²€ì¦, ì‹¤ì‹œê°„ ê²€ì¦ ì—†ì´ ì œì¶œ ì‹œ ê²€ì¦                           |
| **ê²°ê³¼** | ë¹ ë¥¸ í”¼ë“œë°±ê³¼ ì„œë²„ ë¶€í•˜ ì‚¬ì´ ê· í˜•, ì¢‹ì€ UX ì œê³µ                                  |

---

## Phase 5 ì™„ë£Œ ìƒíƒœ ìš”ì•½

| í•­ëª© | ë‚´ìš© | ìƒíƒœ |
|-----|------|------|
| 5-1 | GenericCrawler êµ¬í˜„ | âœ… ì™„ë£Œ |
| 5-2 | CrawlerFactory í™•ì¥ | âœ… ì™„ë£Œ |
| 5-3 | ì—ëŸ¬ í•¸ë“¤ë§ ì‹œìŠ¤í…œ | âœ… ì™„ë£Œ |
| 5-4 | Frontend ì…ë ¥ ê²€ì¦ UI | âœ… ì™„ë£Œ |

**Phase 5 í¬ë¡¤ëŸ¬ í™•ì¥ & ì…ë ¥ ê²€ì¦ ì „ì²´ ì™„ë£Œ! ğŸ‰**

